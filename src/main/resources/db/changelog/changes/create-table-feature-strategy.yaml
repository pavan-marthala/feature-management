databaseChangeLog:
  - changeSet:
      id: feature_strategy-1
      author: pavan
      changes:
        - createTable:
            tableName: feature_strategy
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: strategy_type
                  type: VARCHAR(255)
              - column:
                  name: feature_id
                  type: UUID
                  constraints:
                    nullable: false

        - addForeignKeyConstraint:
            baseTableName: feature_strategy
            baseColumnNames: feature_id
            referencedTableName: feature
            referencedColumnNames: id
            constraintName: fk_feature_strategy_feature

  # BooleanFeatureStrategyEntity table
  - changeSet:
      id: boolean_feature_strategy-1
      author: pavan
      changes:
        - createTable:
            tableName: boolean_feature_strategy
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: value
                  type: BOOLEAN

        - addForeignKeyConstraint:
            baseTableName: boolean_feature_strategy
            baseColumnNames: id
            referencedTableName: feature_strategy
            referencedColumnNames: id
            constraintName: fk_boolean_strategy_strategy

  # ScheduleFeatureStrategyEntity table
  - changeSet:
      id: schedule_feature_strategy-1
      author: pavan
      changes:
        - createTable:
            tableName: schedule_feature_strategy
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: cron
                  type: VARCHAR(255)

        - addForeignKeyConstraint:
            baseTableName: schedule_feature_strategy
            baseColumnNames: id
            referencedTableName: feature_strategy
            referencedColumnNames: id
            constraintName: fk_schedule_strategy_strategy

  # JWTClaimFeatureStrategyEntity table and embedded claims
  - changeSet:
      id: jwt_claim_feature_strategy-1
      author: pavan
      changes:
        - createTable:
            tableName: jwt_claim_feature_strategy
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                    nullable: false

        - addForeignKeyConstraint:
            baseTableName: jwt_claim_feature_strategy
            baseColumnNames: id
            referencedTableName: feature_strategy
            referencedColumnNames: id
            constraintName: fk_jwt_claim_strategy_strategy

        - createTable:
            tableName: jwt_claims
            columns:
              - column:
                  name: strategy_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: value
                  type: VARCHAR(255)
                  constraints:
                    nullable: false

        - addForeignKeyConstraint:
            baseTableName: jwt_claims
            baseColumnNames: strategy_id
            referencedTableName: jwt_claim_feature_strategy
            referencedColumnNames: id
            constraintName: fk_jwt_claims_strategy
            onDelete: CASCADE

        - addPrimaryKey:
            tableName: jwt_claims
            columnNames: strategy_id, name
            constraintName: pk_jwt_claims

  # HTTPRequestFeatureStrategyEntity table and embedded fields
  - changeSet:
      id: http_request_feature_strategy-1
      author: pavan
      changes:
        - createTable:
            tableName: http_request_feature_strategy
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                    nullable: false

              # For @Embedded HTTPHeader fields — example: header_name, header_value
              - column:
                  name: header_name
                  type: VARCHAR(255)
              - column:
                  name: header_value
                  type: VARCHAR(255)

              # For @Embedded HTTPRequestBody fields — define fields inside HTTPRequestBody as columns here
              - column:
                  name: request_body_path
                  type: VARCHAR(255)
              - column:
                  name: request_body_value
                  type: TEXT

              # For @Embedded HTTPQuery fields — example: query_param, query_value
              - column:
                  name: query_name
                  type: VARCHAR(255)
              - column:
                  name: query_value
                  type: VARCHAR(255)

        - addForeignKeyConstraint:
            baseTableName: http_request_feature_strategy
            baseColumnNames: id
            referencedTableName: feature_strategy
            referencedColumnNames: id
            constraintName: fk_http_request_strategy_strategy
